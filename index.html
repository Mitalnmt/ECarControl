
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Xe Cho Thu√™</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      justify-content: space-between;
    }

    .modal-content {
      max-height: 90vh; /* Chi·ªÅu cao t·ªëi ƒëa 90% viewport height */
      overflow-y: auto;
    }

    /* T√πy ch·ªânh cho modal ch·ªçn xe */
    #carModal .modal-dialog {
      max-width: 95%;
      margin: 10px auto;
    }

    #carModal .modal-body {
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    #carModal .mb-2 {
      display: flex;
      flex-wrap: wrap;
      justify-content: flex-start;
      gap: 5px;
    }

    #carModal .btn-secondary {
      min-width: 60px;
      margin: 2px !important;
      padding: 8px 12px;
    }

    /* Responsive adjustments */
    @media (min-width: 768px) {
      #carModal .modal-dialog {
        max-width: 700px;
      }

      #carModal .mb-2 {
        justify-content: flex-start;
      }

      #carModal .btn-secondary {
        min-width: 70px;
        padding: 10px 15px;
      }
    }

    .countdown {
      font-weight: bold;
      color: red;
      font-size: 1.1em;
    }
    .countdown.urgent {
      color: #d10000; /* M√†u ƒë·ªè ƒë·∫≠m khi g·∫ßn h·∫øt gi·ªù */
      text-shadow: 0 0 5px rgba(255,0,0,0.3);
    }

    .done {
      background-color: lightgreen;
    }
    .overdue {
      background-color: #ff7f7f; /* M√†u ƒë·ªè nh·∫°t */
      animation: blink 1s infinite alternate; /* Th√™m hi·ªáu ·ª©ng nh·∫•p nh√°y */
    }
    @keyframes blink {
      from { opacity: 1; }
      to { opacity: 0.7; }
    }
  </style>
</head>
<body>
  <!-- Main content -->
      <div class="container mt-3">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h3 class="mb-0">Danh s√°ch xe cho thu√™</h3>
        <div class="d-flex align-items-center gap-2">
          <small class="text-muted" title="·∫§n gi·ªØ v√†o d√≤ng ƒë·ªÉ m·ªü menu thao t√°c">üí° ·∫§n gi·ªØ d√≤ng ƒë·ªÉ m·ªü menu</small>
          <button class="btn btn-outline-secondary btn-sm" id="fullscreenBtn" title="To√†n m√†n h√¨nh">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M1.5 1a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-.5.5h-1a.5.5 0 0 0 0 1H1v1a.5.5 0 0 0 1 0V7h1a.5.5 0 0 0 0-1H1V1.5a.5.5 0 0 0-.5-.5z"/>
              <path d="M14.5 1a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h1a.5.5 0 0 1 0 1H16v1a.5.5 0 0 1-1 0V7h-1a.5.5 0 0 1 0-1h1V1.5a.5.5 0 0 1 .5-.5z"/>
            </svg>
          </button>
        </div>
      </div>
    <table class="table table-striped" id="car-list">
      <thead>
        <tr>
          <th>#</th>
          <th>Tr·∫°ng th√°i</th>
          <th>M√£ xe</th>
          <th>Th·ªùi gian</th>
          <th>C√≤n l·∫°i</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- List of cars will be inserted here -->
      </tbody>
    </table>
  </div>

  <!-- Bottom bar ƒë·∫∑t ngo√†i container ƒë·ªÉ lu√¥n n·ªïi tr√™n m√†n h√¨nh -->
  <div id="bottomBar" class="d-flex justify-content-between align-items-center px-3 py-2">
    <button class="btn btn-secondary" id="settingsBtn">C√†i ƒë·∫∑t</button>
    <button class="btn btn-primary" id="showModalBtn" data-bs-toggle="modal" data-bs-target="#carModal">Ch·ªçn Xe</button>
    <button class="btn btn-info" id="selectMultipleBtn" data-bs-toggle="modal" data-bs-target="#selectMultipleModal">Ch·ªçn Nhi·ªÅu</button>
  </div>

  <!-- Modal -->
<div class="modal fade" id="carModal" tabindex="-1" aria-labelledby="carModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="carModalLabel">Ch·ªçn Xe</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A1')">A1</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A12')">A12</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A13')">A13</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A14')">A14</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A15')">A15</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A16')">A16</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A17')">A17</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A18')">A18</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A19')">A19</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('A20')">A20</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('AB')">AB</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('C1')">C1</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('C2')">C2</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('C3')">C3</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('C4')">C4</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('CC')">CC</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('CX')">CX</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('M1')">M1</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('M2')">M2</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('M3')">M3</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('D3')">D3</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('Xƒê')">Xƒê</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('XT')">XT</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('XV')">XV</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('S1')">S1</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('S2')">S2</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('S3')">S3</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('S4')">S4</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('03')">03</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('06')">06</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('09')">09</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('10')">10</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('25')">25</button>
          </div>
          <div class="mb-2">
            <button class="btn btn-secondary m-1" onclick="selectCarCode('ƒêM')">ƒêM</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('ƒêC')">ƒêC</button>
            <button class="btn btn-secondary m-1" onclick="selectCarCode('VH')">VH</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal x√°c nh·∫≠n x√≥a t·∫•t c·∫£ -->
  <div class="modal fade" id="confirmDeleteAllModal" tabindex="-1" aria-labelledby="confirmDeleteAllLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmDeleteAllLabel">X√°c nh·∫≠n x√≥a t·∫•t c·∫£</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a to√†n b·ªô danh s√°ch xe? <br>H√£y ·∫•n n√∫t x√°c nh·∫≠n 5 l·∫ßn ƒë·ªÉ th·ª±c hi·ªán!</p>
          <button class="btn btn-danger" id="confirmDeleteAllBtn">X√°c nh·∫≠n (<span id="confirmDeleteAllCount">0</span>/5)</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ch·ªçn th·ªùi gian cho t·ª´ng xe -->
  <div class="modal fade" id="timeModal" tabindex="-1" aria-labelledby="timeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="timeModalLabel">Ch·ªânh th·ªùi gian xe</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <button class="btn btn-danger m-1" id="minus5Btn">-5 min</button>
          <button class="btn btn-warning m-1" id="minus1Btn">-1 min</button>
          <button class="btn btn-success m-1" id="plus1Btn">+1 min</button>
          <button class="btn btn-success m-1" id="plus5Btn">+5 min</button>
          <button class="btn btn-secondary m-1" id="nullTimeBtn">Null</button>
          <hr>
          <div class="mt-2">
            <button class="btn btn-info m-1" id="minusExtraBtn">-1 xu·∫•t</button>
            <button class="btn btn-info m-1" id="plusExtraBtn">+1 xu·∫•t</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal c√†i ƒë·∫∑t -->
  <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="settingsModalLabel">C√†i ƒë·∫∑t</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="defaultTimeInput" class="form-label">Th·ªùi gian ƒë·∫øm ng∆∞·ª£c m·∫∑c ƒë·ªãnh:</label>
            <div class="row">
              <div class="col-6">
                <label for="defaultMinutesInput" class="form-label">Ph√∫t:</label>
                <input type="number" class="form-control" id="defaultMinutesInput" min="0" max="59" value="15">
              </div>
              <div class="col-6">
                <label for="defaultSecondsInput" class="form-label">Gi√¢y:</label>
                <input type="number" class="form-control" id="defaultSecondsInput" min="0" max="59" value="0">
              </div>
            </div>
            <small class="text-muted">Th·ªùi gian m·∫∑c ƒë·ªãnh: <span id="defaultTimeDisplay">15:00</span></small>
          </div>

          <div class="mb-3">
            <label for="defaultExtraInput" class="form-label">Th√™m xu·∫•t m·∫∑c ƒë·ªãnh:</label>
            <div class="row">
              <div class="col-6">
                <label for="defaultExtraMinutesInput" class="form-label">Ph√∫t:</label>
                <input type="number" class="form-control" id="defaultExtraMinutesInput" min="1" max="60" value="15">
              </div>
              <div class="col-6">
                <label class="form-label">&nbsp;</label>
                <div class="form-control-plaintext">
                  <small class="text-muted">Th·ªùi gian xu·∫•t: <span id="defaultExtraDisplay">15 ph√∫t</span></small>
                </div>
              </div>
            </div>
            <small class="text-muted">Th·ªùi gian c·ªông/tr·ª´ khi ·∫•n n√∫t "-1 xu·∫•t" ho·∫∑c "+1 xu·∫•t"</small>
          </div>

          
          <div class="mb-3">
            <label class="form-label">Ch·ªânh s·ª≠a Menu Xe:</label>
            <div class="d-flex gap-2 mb-2">
              <button class="btn btn-primary" id="openCarMenuEditorBtn">M·ªü Editor</button>
              <button class="btn btn-warning" id="resetCarMenuBtn">Reset v·ªÅ m·∫∑c ƒë·ªãnh</button>
            </div>
            <small class="text-muted">Ch·ªânh s·ª≠a c√°c nh√≥m xe v√† th·ª© t·ª± hi·ªÉn th·ªã trong menu ch·ªçn xe.</small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-warning" id="backBtn" title="Quay l·∫°i (Ctrl+Z)">‚Üê Back</button>
          <button type="button" class="btn btn-info" id="exportCarsBtn">Xu·∫•t danh s√°ch xe</button>
          <button type="button" class="btn btn-warning" id="enableNotifyBtn">B·∫≠t th√¥ng b√°o</button>
          <button type="button" class="btn btn-danger" id="deleteAllBtn">X√≥a t·∫•t c·∫£</button>
          <button type="button" class="btn btn-danger" id="logoutBtn">ƒêƒÉng xu·∫•t</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
          <button type="button" class="btn btn-primary" id="saveSettingsBtn">L∆∞u c√†i ƒë·∫∑t</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal thao t√°c d√≤ng -->
  <div class="modal fade" id="rowActionModal" tabindex="-1" aria-labelledby="rowActionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="rowActionModalLabel">Ch·ªçn thao t√°c</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <button class="btn btn-info m-2" id="rowActionTimeBtn">Time</button>
          <button class="btn btn-danger m-2" id="rowActionDeleteBtn">X√≥a</button>
          <button class="btn btn-secondary m-2" id="rowActionNoteBtn">Ghi ch√∫</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ch·ªânh s·ª≠a menu xe -->
  <div class="modal fade" id="carMenuEditorModal" tabindex="-1" aria-labelledby="carMenuEditorModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="carMenuEditorModalLabel">Ch·ªânh s·ª≠a Menu Xe</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="carMenuEditorContainer">
            <!-- N·ªôi dung editor s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
          <button type="button" class="btn btn-primary" id="applyCarMenuChangesBtn">√Åp d·ª•ng thay ƒë·ªïi</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ch·ªçn nhi·ªÅu xe -->
  <div class="modal fade" id="selectMultipleModal" tabindex="-1" aria-labelledby="selectMultipleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="selectMultipleModalLabel">Ch·ªçn Nhi·ªÅu Xe</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="multipleCarSelectionContainer">
            <!-- N·ªôi dung ch·ªçn xe s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
          <button type="button" class="btn btn-primary" id="addSelectedCarsBtn">Th√™m xe ƒë√£ ch·ªçn</button>
        </div>
      </div>
    </div>
  </div>

  <div class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
    <div id="overdueToast" class="toast align-items-center text-white bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="overdueToastBody">
          C√≥ xe v·ª´a h·∫øt th·ªùi gian!
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAj8MNZXEN1tQaOqZ4jGxGhX04IWAW437s",
      authDomain: "xehtml.firebaseapp.com",
      databaseURL: "https://xehtml-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "xehtml",
      storageBucket: "xehtml.firebasestorage.app",
      messagingSenderId: "295057234622",
      appId: "1:295057234622:web:814425305c34e22cf81cef",
      measurementId: "G-CEQ6GP1D3Z"
    };
    firebase.initializeApp(firebaseConfig);
    window.db = firebase.database();
  </script>
  <script src="script.js"></script>
  <script src="car-menu-editor.js"></script>
  <script src="multiple-car-selection.js"></script>
</body>
</html>